<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="generator" content="made with love by dartdoc 7.0.1-wip">
  <meta name="description" content="spot API docs, for the Dart programming language.">
  <title>spot - Dart API docs</title>


  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" rel="stylesheet">
  
  <link rel="stylesheet" href="static-assets/github.css?v1">
  <link rel="stylesheet" href="static-assets/styles.css?v1">
  <link rel="icon" href="static-assets/favicon.png?v1">

  
</head>


<body data-base-href="" data-using-base-href="false" class="light-theme">

<div id="overlay-under-drawer"></div>

<header id="title">
  <span id="sidenav-left-toggle" class="material-symbols-outlined" role="button" tabindex="0">menu</span>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li class="self-crumb">spot package</li>
  </ol>
  <div class="self-name">spot</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
  <div class="toggle" id="theme-button">
    <label for="theme">
      <input type="checkbox" id="theme" value="light-theme">
      <span id="dark-theme-button" class="material-symbols-outlined">
        brightness_4
      </span>
      <span id="light-theme-button" class="material-symbols-outlined">
        brightness_5
      </span>
    </label>
  </div>
</header>
<main>

  <div id="dartdoc-main-content" class="main-content">
      
<section class="desc markdown">
  <h1 id="spot">Spot</h1>
<p><a href="https://pub.dev/packages/spot"><img src="https://img.shields.io/pub/v/spot?include_prereleases" alt="pub"></a></p>
<img src="https://user-images.githubusercontent.com/1096485/188243198-7abfc785-8ecd-40cb-bb28-5561610432a4.png" height="100px">
<p>Fluent, chainable Widget finders and better assertions for Flutter widget tests</p>
<p>‚õìÔ∏è Chainable widget selectors
üíô Prints helpful error messages</p>
<h2 id="usage">Usage</h2>
<pre class="language-dart"><code class="language-dart">import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:spot/spot.dart';

void main() {
  testWidgets('Widget test with spot', (tester) async {
    // Create widget selectors for elements in the widget tree
    final scaffold = spot&lt;MaterialApp&gt;().spot&lt;Scaffold&gt;();
    final appBar = scaffold.spot&lt;AppBar&gt;();
    
    // Assert for values of widgets
    appBar.spotText('Dash').hasFontSize(14).hasFontColor(Colors.black87);
    
    // Find widgets based on child widgets
    appBar
        .spot&lt;IconButton&gt;(children: [spotIcon(Icons.home)])
        .existsOnce()
        .hasTooltip('home');

    // Find widgets based on multiple parent widgets
    spot&lt;Icon&gt;(parents: [appBar, spot&lt;IconButton&gt;()])
        .existsExactlyNTimes(2)
        .all((icon) {
      icon.hasColorWhere((color) =&gt; color.equals(Colors.black));
    });

    // Interact with widgets using `act`
    final button = spot&lt;FloatingActionButton&gt;();
    await act.tap(button);
  });
}

</code></pre>
<p>Take screenshots of your entire screen or single widgets to see what's going on.</p>
<pre class="language-dart"><code class="language-dart">import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:spot/spot.dart';

void main() {
  testWidgets('Take screenshots', (tester) async {
    tester.pumpWidget(MyApp());
    
    // Take a screenshot of the entire screen
    await takeScreenshot();
    // console:
    // Screenshot file:///var/folders/0j/p0s0zrv91tgd33zrxb88c0440000gn/T/spot/screenshot_test:10-s83dv.png
    //   taken at main.&lt;fn&gt; file:///Users/pascalwelsch/Projects/passsy/spot/test/spot/screenshot_test.dart:10:10
    
    // Take a screenshot of a single widget
    await spot&lt;AppBar&gt;().takeScreenshot();
    // console:
    // Screenshot file:///var/folders/0j/p0s0zrv91tgd33zrxb88c0440000gn/T/spot/screenshot_test:16-w8UPv.png
    //   taken at main.&lt;fn&gt; file:///Users/pascalwelsch/Projects/passsy/spot/test/spot/screenshot_test.dart:16:24
  });
}
</code></pre>
<h3 id="chain-selectors">Chain selectors</h3>
<p>You know exactly where your widgets are.
Like a button in the AppBar or a Text in a Dialog.
Spot allows you to chain matchers, narrowing down the search space.</p>
<p>Chaining allows spot to create better error messages for you.
Spot follows the chain of your selectors and can tell you exactly where the widget is missing.
Like: <code>Could not find "IconButton" in "AppBar", but found these widgets instead: &lt;AppBar-widget-tree&gt;.</code></p>
<pre class="language-dart"><code class="language-dart">spot&lt;AppBar&gt;().spot&lt;IconButton&gt;();
spot&lt;IconButton&gt;(parents: [spot&lt;AppBar&gt;()]);
</code></pre>
<p>Both syntax are identical. The first is shorter for when you only need a single parent.
The second allows checking for multiple parents, which is only required for rare use cases.</p>
<h3 id="selectors">Selectors</h3>
<p>Spot has two features, creating <strong>selectors</strong> and asserting on them with <strong>matchers</strong>.</p>
<p>A selector is a query to find a set of widgets.
Like a SQL query, or a CSS selector.
It is only a description of what to search for, without actually doing the search.</p>
<p>Selectors can be rather complex, it is therefore recommended to <strong>reuse</strong> them.
You can even save them top-level and reuse them across multiple tests.</p>
<pre class="language-dart"><code class="language-dart">spot&lt;ElevatedButton&gt;();

final WidgetSelector&lt;TextField&gt; textFields = 
    spot&lt;LoginScreen&gt;().spot&lt;LoginForm&gt;().spot&lt;TextField&gt;();

final WidgetSelector&lt;TextField&gt; usernameTextField =
    spot&lt;TextField&gt;(
      parents: [
        spot&lt;TextWithLabel&gt;(
          children: [
            spotText('Username'),
          ],
        ),
      ],
    );
</code></pre>
<p>A <code>WidgetSelector</code> may return 0, 1 or N widgets.
Depending on how many widgets you expect to find, you should use the corresponding matchers.</p>
<h3 id="matchers">Matchers</h3>
<p>After creating a selector, you want to assert the widgets it found.
The <code>snapshot()</code> method creates a <code>WidgetSnapshot</code> of the widget tree at that point in time and finds all widgets that match the selector.</p>
<h4 id="quantity-matchers">Quantity matchers</h4>
<p>The easiest matchers are the quantity matchers. They allow checking how many widgets were found.</p>
<ul>
<li><code>existsOnce()</code> asserts that exactly one widget was found</li>
<li><code>doesNotExist()</code> asserts that no widget was found</li>
<li><code>existsExactlyNTimes(n)</code> asserts that exactly <code>n</code> widgets were found</li>
<li><code>existsAtLeastOnce()</code> asserts that at least one widget was found</li>
<li><code>existsAtMostOnce()</code> asserts that at most one widget was found</li>
</ul>
<pre class="language-dart"><code class="language-dart">
final selector = spot&lt;ElevatedButton&gt;();

// calls snapshot() internally
final matchOne = selector.existsOnce(); 
final matchMultiple = selector.existsExactlyNTimes(5);

selector.doesNotExist(); // end, nothing to match on 
</code></pre>
<h4 id="property-matchers">Property matchers</h4>
<p>The property matchers allow asserting on the properties of the widgets.
You don't have to use <code>execpt()</code>, instead you can use the <code>has*</code>/<code>is*</code> matchers directly.</p>
<pre class="language-dart"><code class="language-dart">spot&lt;Tooltip&gt;()
    .existsOnce() // takes snapshot and asserts quantity
    // start your chain of matchers
    .hasMessage('Favorite')
    .hasShowDurationWhere(
      (it) =&gt; it.isGreaterOrEqual(Duration(seconds: 1000)),
    )
    .hasTriggerMode(TooltipTriggerMode.longPress);
</code></pre>
<p>To match multiple widgets use <code>all()</code> or <code>any()</code></p>
<pre class="language-dart"><code class="language-dart">spot&lt;AppBar&gt;().spot&lt;Tooltip&gt;().existsAtLeastOnce()
    .all((tooltip) =&gt; tooltip
      .hasShowDurationWhere((it) =&gt; it.isGreaterOrEqual(Duration(seconds: 1000)))
      .hasTriggerMode(TooltipTriggerMode.longPress)
    );
</code></pre>
<h3 id="selectors-vs-matchers">Selectors vs Matchers</h3>
<p>It is recommended to use matchers instead of selectors once you have narrowed down the search space to the widget you want to assert on.
This makes the error messages much clearer.
Instead of <code>widget not found</code> you'll get <code>Found ToolTip with message 'Settings' but expected 'Favorite'</code> as error message.</p>
<pre class="language-dart"><code class="language-dart">// DON'T
spot&lt;Tooltip&gt;()
    .withMessage('Favorite') // selector
    .withTriggerMode(TooltipTriggerMode.longPress) // selector
    .existsOnce();

// DO
spot&lt;Tooltip&gt;()
    .existsOnce()
    .hasMessage('Favorite') // matcher
    .hasTriggerMode(TooltipTriggerMode.longPress); // matcher
</code></pre>
<h3 id="better-errors">Better errors</h3>
<p>In case the settings icon doesn't exist you usually would get the following error using <code>findsOneWidget</code></p>
<pre class="language-dart"><code>expect(find.byIcon(Icons.settings), findsOneWidget);

&gt;&gt;&gt; Expected: exactly one matching node in the widget tree
&gt;&gt;&gt;   Actual: _WidgetIconFinder:&lt;zero widgets with icon "IconData(U+0E57F)" (ignoring offstage widgets)&gt;
&gt;&gt;&gt;    Which: means none were found but one was expected
</code></pre>
<p>The error message above is not really helpful, because the actual error is not that there's no icon, but the <code>Icons.home</code> instead of <code>Icons.settings</code>.</p>
<p>spot prints the entire widget tree and shows that there is an <code>Icon</code>, but the wrong one (<code>IconData(U+0E318)</code>).
That's much more helpful!</p>
<p>In the future, spot will only print the widget tree from the last node found node (<code>spot&lt;AppBar&gt;</code>).</p>
<pre class="language-dart"><code>spot&lt;AppBar&gt;().spotIcon(Icons.settings).existsOnce();

Could not find 'icon "IconData(U+0E57F)"' as child of #2 type "IconButton"
There are 1 possible parents for 'icon "IconData(U+0E57F)"' matching #2 type "IconButton". But non matched. The widget trees starting at #2 type "IconButton" are:
Possible parent 0:
IconButton(Icon, padding: EdgeInsets.all(8.0), dependencies: [_InheritedTheme, IconTheme, _LocalizationsScope-[GlobalKey#bdafc]])
‚îîSemantics(container: false, properties: SemanticsProperties, renderObject: RenderSemanticsAnnotations#9b22d relayoutBoundary=up13)
 ‚îîInkResponse
  ‚îî_InkResponseStateWidget(gestures: [tap], mouseCursor: SystemMouseCursor(click), BoxShape.circle, dependencies: [MediaQuery], state: _InkResponseState#181bf)
   ‚îî_ParentInkResponseProvider
    ‚îîActions(dispatcher: null, actions: {ActivateIntent: CallbackAction&lt;ActivateIntent&gt;#fded7, ButtonActivateIntent: CallbackAction&lt;ButtonActivateIntent&gt;#5d1ad}, state: _ActionsState#f4947)
     ‚îî_ActionsMarker
      ‚îîFocus(dependencies: [_FocusMarker], state: _FocusState#3db93)
       ‚îî_FocusMarker
        ‚îîSemantics(container: false, properties: SemanticsProperties, renderObject: RenderSemanticsAnnotations#d907f relayoutBoundary=up14)
         ‚îîMouseRegion(listeners: [enter, exit], cursor: SystemMouseCursor(click), renderObject: RenderMouseRegion#49c96 relayoutBoundary=up15)
          ‚îîSemantics(container: false, properties: SemanticsProperties, renderObject: RenderSemanticsAnnotations#e83d5 relayoutBoundary=up16)
           ‚îîGestureDetector(startBehavior: start, dependencies: [MediaQuery])
            ‚îîRawGestureDetector(state: RawGestureDetectorState#2d012(gestures: [tap], excludeFromSemantics: true, behavior: opaque))
             ‚îîListener(listeners: [down], behavior: opaque, renderObject: RenderPointerListener#cab1c relayoutBoundary=up17)
              ‚îîConstrainedBox(BoxConstraints(48.0&lt;=w&lt;=Infinity, 48.0&lt;=h&lt;=Infinity), renderObject: RenderConstrainedBox#96a26 relayoutBoundary=up18)
               ‚îîPadding(padding: EdgeInsets.all(8.0), dependencies: [Directionality], renderObject: RenderPadding#c223d relayoutBoundary=up19)
                ‚îîSizedBox(width: 24.0, height: 24.0, renderObject: RenderConstrainedBox#d47d4 relayoutBoundary=up20)
                 ‚îîAlign(alignment: Alignment.center, dependencies: [Directionality], renderObject: RenderPositionedBox#ac4b6)
                  ‚îîBuilder(dependencies: [IconTheme])
                   ‚îîIconTheme(color: Color(0xffffffff), size: 24.0)
                    ‚îîIcon(IconData(U+0E318), dependencies: [Directionality, IconTheme])
                     ‚îîSemantics(container: false, properties: SemanticsProperties, renderObject: RenderSemanticsAnnotations#ec9ab relayoutBoundary=up1)
                      ‚îîExcludeSemantics(excluding: true, renderObject: RenderExcludeSemantics#5b179 relayoutBoundary=up2)
                       ‚îîSizedBox(width: 24.0, height: 24.0, renderObject: RenderConstrainedBox#eefd6 relayoutBoundary=up3)
                        ‚îîCenter(alignment: Alignment.center, dependencies: [Directionality], renderObject: RenderPositionedBox#4c194)
                         ‚îîRichText(textDirection: ltr, softWrap: wrapping at box width, overflow: visible, maxLines: unlimited, text: "Óåò", dependencies: [_LocalizationsScope-[GlobalKey#bdafc]], renderObject: RenderParagraph#35451 relayoutBoundary=up1)
‚ïê‚ïê‚ï° EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK ‚ïû‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
The following TestFailure was thrown running a test:
Could not find 'icon "IconData(U+0E57F)"' as child of [type "MaterialApp" &gt; 'type "Scaffold"' &gt;
'type "AppBar"' &amp;&amp; type "IconButton"]
</code></pre>
<h2 id="roadmap">Roadmap</h2>
<ul>
<li>‚úÖ Make chainable <code>WidgetSelector</code>s</li>
<li>‚úÖ Print full widget tree when assertions fail</li>
<li>‚úÖ Allow defining <code>WidgetSelector</code> with children</li>
<li>‚úÖ Allow defining <code>WidgetSelector</code> with parents</li>
<li>‚úÖ Interop with <code>Finder</code> API</li>
<li>‚úÖ Match properties of widgets (via <code>DiagnosticsNode</code>)</li>
<li>‚úÖ Allow matching of nested properties (with checks API)</li>
<li>‚úÖ Generate code for custom properties for Flutter widgets</li>
<li>‚úÖ Allow generating code for properties of 3rd party widgets</li>
<li>‚úÖ Interact with widgets (<code>act</code>)</li>
<li>‚úÖ Allow manually printing a screenshot at certain points</li>
<li>‚úÖ Negate child matchers</li>
<li>‚úÖ Simplify <code>WidgetSelector</code> API</li>
<li>‚¨úÔ∏è Become the de facto Widget selector API for <a href="https://pub.dev/packages/patrol">patrol</a></li>
<li>‚¨úÔ∏è Combine multiple WidgetSelectors with <code>and</code></li>
<li>‚¨úÔ∏è More <code>act</code> features</li>
<li>‚¨úÔ∏è Print only widget tree of the parent scope when test fails</li>
<li>‚¨úÔ∏è Create screenshot when test fails</li>
<li>‚¨úÔ∏è Automatically create report with screenshots of all user interactions</li>
<li>‚¨úÔ∏è Create interactive HTML page with all widgets and matchers when test fails</li>
</ul>
<h2 id="project-state">Project state</h2>
<p>Spot is used in production by many apps already.
The current plan is to merge spot somehow with <a href="https://pub.dev/packages/patrol">patrol</a>, the next big milestone.</p>
<p>The public <code>spot&lt;X&gt;()</code> API just received a rework in <code>0.10.0</code> which cleans up and simplifies the API. (Awaiting feedback)
The <code>act</code> API is still experimental and has known issues. (WIP)</p>
<p>Even though things are still fluid, <code>spot</code> today already provides a lot of value over the traditional <code>finder</code> API.</p>
<h2 id="license">License</h2>
<pre class="language-dart"><code>Copyright 2022 Pascal Welsch

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</code></pre>
</section>


      <section class="summary">
          <h2>Libraries</h2>
        <dl>
          <dt id="spot">
  <span class="name"><a href="spot/spot-library.html">spot</a></span> 

</dt>
<dd>Spot is a library for testing the Widget tree of Flutter apps.
</dd>

        </dl>
      </section>

  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-left" class="sidebar sidebar-offcanvas-left">
    <!-- The search input and breadcrumbs below are only responsively visible at low resolutions. -->
<header id="header-search-sidebar" class="hidden-l">
  <form class="search-sidebar" role="search">
    <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
    <li class="self-crumb">spot package</li>
</ol>


    <h5 class="hidden-xs"><span class="package-name">spot</span> <span class="package-kind">package</span></h5>
    <ol>
      <li class="section-title">Libraries</li>
      <li><a href="spot/spot-library.html">spot</a></li>
</ol>

  </div>

  <div id="dartdoc-sidebar-right" class="sidebar sidebar-offcanvas-right">
  </div>

</main>

<footer>
  <span class="no-break">
    spot
      0.10.0-beta.1
  </span>

  
</footer>



<script src="static-assets/highlight.pack.js?v1"></script>
<script src="static-assets/docs.dart.js"></script>



</body>

</html>

